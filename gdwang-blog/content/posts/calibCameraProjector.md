---
title: "CalibCameraProjector"
date: 2023-01-29T14:49:47+08:00
draft: false
---

# 单目相机与投射器的标定
## 1.思路
- 计算极点坐标；
- 计算极点方向；  

第一种思路: 由于投射器安装在相机x轴方向上，且安装误差本身不会特别大，导致极点坐标(相机投射器连线与归一化平面的交点)接近在无穷远处。拍摄两个平面，两对correspond points 构成的两条直线接近平行，此时交点在无穷远。采用这种方式获得的极点坐标分布不均匀，误差较大。  

第二种思路：投射器发出去的散斑点打在两个平面上，再被相机接收后成像。这个过程可以认为两个平面是同源的(planar homology), 构成平面透射关系。可以先计算单应性矩阵H, 极点方向可以通过参数化单应矩阵H获取。构建重投影误差，获得最优参数，再从参数中恢复极点方向。

## 2 平面透射
从一个光源发出去的光打在两个平面上，典型的例子就是墙面及其阴影，如下图(c)所示；

![image](/img/calibCameraProjector/planar_homology.png)  

(a). 同一个平面在不同视角下；(b). 纯旋转； (c). 平面透射

## 3 参数化
平面透射(planar homology)对应的单应性矩阵$H$, 满足
$$
x' = H x，
$$
矩阵$H$有5个自由度，可以用顶点 $\rm v$，轴 $\rm a$，交比 $\mu$ 来参数化表示，
$$
\rm H = \rm I +  (\mu-1)\frac{va^T}{v^Ta}，
$$
考虑齐次性，取$a(2)=v(0)=1$, 只剩下5个参数，可以使用向量$\Theta = \\{a(0), a(1), v(1), v(2), \mu\\}$ 来参数化单应矩阵 $H$。

从代数上来说，$H$有两个相同的特征值和一个不同的特征值，通过本征值分解来参数化表示$H$，

- 轴$a$为两个相同特征值的叉积；
- 顶点$v$为不同特征值对应的特征向量；
- 交比$\mu$为不同特征值与相同特征值的比值；

## 4. 重投影误差
构建重投影误差迭代优化，
$$
E(\Theta) = \sum_i^M(x'_i,\Theta x_i)
$$
从`cv::findHomography()`获取初始$H_0$,分解得到$\Theta_0$。依据最终优化结果，过滤重投影误差超过1pixel的匹配点对， 记剩余匹配点对数量为N。

## 5. 亚像素处理






